# Rust Jax FFI

This repo contains an adaption of the [JAX foreign function interface tutorial](https://docs.jax.dev/en/latest/ffi.html) to Rust. This was inspired by [extending-jax](https://github.com/jeertmans/extending-jax), but differs from it in some important ways. Mainly, building the python package was done from c++'s [nanobind](https://github.com/wjakob/nanobind) as opposed to Rust's [maturin](https://github.com/PyO3/maturin). This enables the flow from langues to be unidirectional. Python looks for bindings generated from C++ and C++ looks for bindings generated by Rust. This is not necessarily the fastest or most memory efficient way of allowing JAX to use Rust code using the foreign function interface but it was the simpilest I could find.

## Requirements
- [cmake](https://cmake.org/download/)
- [python](https://www.python.org/downloads/)
- [uv](https://docs.astral.sh/uv/)
- [rust and cargo](https://www.rust-lang.org/tools/install)

## Setup

1. Clone or fork the repo then run:
```
git clone https://github.com/<GITHUB_USERNAME>/rust-jax-ffi.git
```
2.  `cd rust-jax-ffi`
3. `uv venv`
4. `uv sync`
5. `source .venv/bin/activate`
6. `cmake -S . -B build -DCMAKE_EXPORT_COMPILE_COMMANDS=ON`
    (This will take a little while)
7. `cmake --build build`
8. `pytest`
